<section class="max-w-6xl mx-auto p-4 grid md:grid-cols-3 gap-6">
  <!-- Colonne gauche : Prestations + Tableau editable + MO & ferrures -->
  <div class="md:col-span-2 space-y-6">
    <!-- Carte : coûts par prestation (affichage) -->
    <div class="rounded-xl border border-neutral-200 bg-white p-4">
      <h2 class="text-xl font-semibold mb-2">Coût de revient par prestation</h2>
      <p class="text-sm text-neutral-500 mb-4">
        Montants en €/m² et €/meuble selon les prestations cochées dans Devis.
      </p>
      <div id="cr-services-list" class="space-y-2"><!-- rempli par JS --></div>
    </div>

    <!-- Carte : tableau éditable de TES coûts par prestation (€/m²) -->
    <div class="rounded-xl border border-neutral-200 bg-white p-4">
      <div class="flex items-center justify-between gap-3 mb-3">
        <h3 class="text-base font-semibold">Mes coûts de revient (€/m²)</h3>
        <button id="btn-cr-reset-costs" type="button"
          class="h-9 px-3 rounded-lg border border-neutral-300 hover:bg-neutral-50 text-sm">
          Réinitialiser mes coûts
        </button>
      </div>

      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead class="text-left text-neutral-500">
            <tr>
              <th class="py-2 pr-3">Prestation</th>
              <th class="py-2 pr-3">Mon CR €/m²</th>
              <th class="py-2">PV €/m² (TTC)</th>
            </tr>
          </thead>
          <tbody id="cr-config-table"><!-- rempli par JS --></tbody>
        </table>
      </div>

      <p class="text-xs text-neutral-500 mt-2">
        Saisie enregistrée localement (navigateur). Laisse vide pour utiliser le coût par défaut / marge.
      </p>
    </div>

    <!-- Carte : main d’œuvre & ferrures -->
    <div class="rounded-xl border border-neutral-200 bg-white p-4">
      <h3 class="text-base font-semibold mb-3">Main d’œuvre & ferrures</h3>

      <div class="grid sm:grid-cols-3 gap-4">
        <!-- coût horaire -->
        <label class="block">
          <span class="text-sm text-neutral-600">Coût horaire MO (€/h)</span>
          <input id="cr-hourly-rate" type="number" min="0" step="0.01" inputmode="decimal"
                 class="mt-1 w-full h-10 px-3 rounded-lg border border-neutral-300 bg-white" placeholder="ex. 25">
        </label>

        <!-- ferrures polissage -->
        <label class="block">
          <span class="text-sm text-neutral-600">Ferrures — polissage (€/pièce)</span>
          <input id="cr-cost-ferrures-polissage" type="number" min="0" step="0.01" inputmode="decimal"
                 class="mt-1 w-full h-10 px-3 rounded-lg border border-neutral-300 bg-white" placeholder="ex. 5">
        </label>

        <!-- ferrures remplacement -->
        <label class="block">
          <span class="text-sm text-neutral-600">Ferrures — remplacement (€/pièce)</span>
          <input id="cr-cost-ferrures-remplacement" type="number" min="0" step="0.01" inputmode="decimal"
                 class="mt-1 w-full h-10 px-3 rounded-lg border border-neutral-300 bg-white" placeholder="ex. 8">
        </label>
      </div>

      <p class="text-xs text-neutral-500 mt-2">
        Ces coûts s’ajoutent au CR fixe (hors temps). Le temps maximum est calculé pour viser au moins <strong>50 € HT/h</strong>.
      </p>
    </div>
  </div>

  <!-- Colonne droite : Récap -->
  <aside class="md:col-span-1">
    <div class="sticky top-20 rounded-xl border border-neutral-200 bg-white p-4 space-y-3">
      <h3 class="text-base font-semibold">Récapitulatif</h3>

      <div class="text-sm text-neutral-500">Surface totale</div>
      <div id="cr-surface" class="text-lg font-semibold">— m²</div>

      <hr class="my-2">

      <div class="text-sm text-neutral-500">Coût de revient / m²</div>
      <div id="cr-m2" class="text-lg font-semibold">— €/m²</div>

      <div class="text-sm text-neutral-500 mt-2">Coût de revient / meuble</div>
      <div id="cr-meuble" class="text-lg font-semibold">— €</div>

      <hr class="my-2">

      <div class="text-sm text-neutral-500">Prix vendu / m²</div>
      <div class="text-sm">HT : <span id="pv-m2-ht" class="font-medium">— €/m²</span></div>
      <div class="text-sm">TTC : <span id="pv-m2-ttc" class="font-medium">— €/m²</span></div>

      <div class="text-sm text-neutral-500 mt-2">Prix vendu total</div>
      <div class="text-sm">HT : <span id="pv-total-ht" class="font-medium">— €</span></div>
      <div class="text-sm">TTC : <span id="pv-total-ttc" class="font-medium">— €</span></div>

      <hr class="my-2">

      <div class="text-sm text-neutral-500">Rentabilité (sur HT)</div>
      <div id="rentabilite" class="text-lg font-semibold">— %</div>

      <div class="text-sm text-neutral-500">Temps max pour ≥ 50 € HT/h</div>
      <div id="cr-tmax" class="text-lg font-semibold">— h</div>

      <p id="cr-hint" class="text-xs text-neutral-500 mt-2 hidden">
        Définis tes coûts (€/m², ferrures, MO) pour un résultat précis.
      </p>
    </div>
  </aside>
</section>
